<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Annotation tables for top SNPs • switchgrassGWAS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Annotation tables for top SNPs">
<meta property="og:description" content="switchgrassGWAS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">switchgrassGWAS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/annotations.html">Annotation tables for top SNPs</a>
    </li>
    <li>
      <a href="../articles/gwas.html">Genome-Wide Association</a>
    </li>
    <li>
      <a href="../articles/mash.html">Multivariate Adaptive Shrinkage</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="annotations_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Annotation tables for top SNPs</h1>
                        <h4 class="author">Alice MacQueen</h4>
            
            <h4 class="date">2020-01-07</h4>
      
      
      <div class="hidden name"><code>annotations.Rmd</code></div>

    </div>

    
    
<div id="annotations-for-top-association" class="section level2">
<h2 class="hasAnchor">
<a href="#annotations-for-top-association" class="anchor"></a>Annotations for Top Association</h2>
<div id="load-annotation-information-for-switchgrass" class="section level3">
<h3 class="hasAnchor">
<a href="#load-annotation-information-for-switchgrass" class="anchor"></a>Load annotation information for switchgrass</h3>
<p>The function <code>pvdiv_table_topsnps</code> creates dataframes containing annotation information for the switchgrass diversity panel. To use this function, first load the provided annotation information from wherever you have saved it (currently, this is version 5.1 of the annotation information for <em>Panicum virgatum</em>):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/AnnotationDbi">AnnotationDbi</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">VariantAnnotation</span><span class="op">)</span>
<span class="va">txdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">loadDb</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"Pvirgatum_516_v5.1.gene.txdb.sqlite"</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-snp-dataset-and-gwas-results" class="section level3">
<h3 class="hasAnchor">
<a href="#load-snp-dataset-and-gwas-results" class="anchor"></a>Load SNP dataset and GWAS results</h3>
<p>We will use the same toy SNP dataset that we used for genome-wide association, and find annotations for the same phenotype, GWAS_CT.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://privefl.github.io/bigsnpr/">bigsnpr</a></span><span class="op">)</span>

<span class="va">snpfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_bigsnp.rds"</span>, package <span class="op">=</span> <span class="st">"switchgrassGWAS"</span><span class="op">)</span>
<span class="va">gwasfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GWAS_datatable_example_GWAS_CT.rds"</span>, 
                        package <span class="op">=</span> <span class="st">"switchgrassGWAS"</span><span class="op">)</span>
                        
<span class="va">gwas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="va">gwasfile</span><span class="op">)</span>
<span class="va">snp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://privefl.github.io/bigsnpr/reference/snp_attach.html">snp_attach</a></span><span class="op">(</span><span class="va">snpfile</span><span class="op">)</span></code></pre></div>
<p>Then, specify the number of top SNPs you want to find annotation information for, a FDR threshold to find annotation information for, and a set of distances away from the associated SNP (in bp) for which to pull annotations. Here, we find genes 1kb and 20kb away from 1) top 10 associations and 2) associations above a FDR of 10%.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anno_tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pvdiv_table_topsnps.html">pvdiv_table_topsnps</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">gwas</span>, type <span class="op">=</span> <span class="st">"bigsnp"</span>, n <span class="op">=</span> <span class="fl">10</span>, 
                                  FDRalpha <span class="op">=</span> <span class="fl">0.1</span>, rangevector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">20000</span><span class="op">)</span>,
                                  snp <span class="op">=</span> <span class="va">snp</span>, txdb <span class="op">=</span> <span class="va">txdb</span><span class="op">)</span></code></pre></div>
<p>Let’s look at the annotations for genes within 1000bp of SNPs above the 10% FDR cutoff. There are eight of these:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anno_tables</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt;      CHR region_start region_end width region_strand Annotation QUERYID  TXID</span>
<span class="co">#&gt; 1 Chr01N     12519246   12520246  1001             * intergenic       1    NA</span>
<span class="co">#&gt; 2 Chr03N     63531271   63532271  1001             * intergenic       2    NA</span>
<span class="co">#&gt; 3 Chr04K     22156506   22157506  1001             -   promoter       3 52592</span>
<span class="co">#&gt; 4 Chr04K     22156506   22157506  1001             * intergenic       3    NA</span>
<span class="co">#&gt; 5 Chr04N     10617255   10618255  1001             + spliceSite       4 54814</span>
<span class="co">#&gt; 6 Chr04N     10617255   10618255  1001             +   promoter       4 54814</span>
<span class="co">#&gt; 7 Chr05N     18870305   18871305  1001             * intergenic       5    NA</span>
<span class="co">#&gt; 8 Chr09N     20376944   20377944  1001             * intergenic       6    NA</span>
<span class="co">#&gt;           Gene ID      POS SNP Effect SNP standard error bigsnpscore</span>
<span class="co">#&gt; 1            &lt;NA&gt; 12519746 -0.7488880          0.1851575   -4.044600</span>
<span class="co">#&gt; 2            &lt;NA&gt; 63531771 -0.9169980          0.2334238   -3.928468</span>
<span class="co">#&gt; 3 Pavir.4KG257000 22157006 -1.9845979          0.4556489   -4.355542</span>
<span class="co">#&gt; 4            &lt;NA&gt; 22157006 -1.9845979          0.4556489   -4.355542</span>
<span class="co">#&gt; 5 Pavir.4NG125700 10617755  1.3069519          0.3282515    3.981556</span>
<span class="co">#&gt; 6 Pavir.4NG125700 10617755  1.3069519          0.3282515    3.981556</span>
<span class="co">#&gt; 7            &lt;NA&gt; 18870805  0.7008009          0.1673845    4.186773</span>
<span class="co">#&gt; 8            &lt;NA&gt; 20377444 -0.9087914          0.2250103   -4.038887</span>
<span class="co">#&gt;        p value   log10p FDR Adjusted p value gene_start gene_end gene_width</span>
<span class="co">#&gt; 1 5.911423e-05 4.228308           0.05448040         NA       NA         NA</span>
<span class="co">#&gt; 2 9.522671e-05 4.021241           0.05713603         NA       NA         NA</span>
<span class="co">#&gt; 3 1.556177e-05 4.807941           0.05448040   22152776 22155906       3131</span>
<span class="co">#&gt; 4 1.556177e-05 4.807941           0.05448040         NA       NA         NA</span>
<span class="co">#&gt; 5 7.668979e-05 4.115262           0.05521665   10617705 10621189       3485</span>
<span class="co">#&gt; 6 7.668979e-05 4.115262           0.05521665   10617705 10621189       3485</span>
<span class="co">#&gt; 7 3.244981e-05 4.488788           0.05448040         NA       NA         NA</span>
<span class="co">#&gt; 8 6.053377e-05 4.218002           0.05448040         NA       NA         NA</span>
<span class="co">#&gt;   gene_strand    pacId    transcriptName         peptideName    Pfam</span>
<span class="co">#&gt; 1        &lt;NA&gt;       NA              &lt;NA&gt;                &lt;NA&gt;    &lt;NA&gt;</span>
<span class="co">#&gt; 2        &lt;NA&gt;       NA              &lt;NA&gt;                &lt;NA&gt;    &lt;NA&gt;</span>
<span class="co">#&gt; 3           - 41648510 Pavir.4KG257000.1 Pavir.4KG257000.1.p PF03140</span>
<span class="co">#&gt; 4        &lt;NA&gt;       NA              &lt;NA&gt;                &lt;NA&gt;    &lt;NA&gt;</span>
<span class="co">#&gt; 5           + 41637433 Pavir.4NG125700.1 Pavir.4NG125700.1.p    &lt;NA&gt;</span>
<span class="co">#&gt; 6           + 41637433 Pavir.4NG125700.1 Pavir.4NG125700.1.p    &lt;NA&gt;</span>
<span class="co">#&gt; 7        &lt;NA&gt;       NA              &lt;NA&gt;                &lt;NA&gt;    &lt;NA&gt;</span>
<span class="co">#&gt; 8        &lt;NA&gt;       NA              &lt;NA&gt;                &lt;NA&gt;    &lt;NA&gt;</span>
<span class="co">#&gt;         Panther Categories  KOG   ec   KO   GO Arabidopsis thaliana homolog</span>
<span class="co">#&gt; 1                     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                         &lt;NA&gt;</span>
<span class="co">#&gt; 2                     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                         &lt;NA&gt;</span>
<span class="co">#&gt; 3 PTHR31549,PTHR31549:SF31 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                  AT3G50120.1</span>
<span class="co">#&gt; 4                     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                         &lt;NA&gt;</span>
<span class="co">#&gt; 5  PTHR12606,PTHR12606:SF1 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                         &lt;NA&gt;</span>
<span class="co">#&gt; 6  PTHR12606,PTHR12606:SF1 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                         &lt;NA&gt;</span>
<span class="co">#&gt; 7                     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                         &lt;NA&gt;</span>
<span class="co">#&gt; 8                     &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;                         &lt;NA&gt;</span>
<span class="co">#&gt;   A. thaliana gene name                A. thaliana gene annotation</span>
<span class="co">#&gt; 1                  &lt;NA&gt;                                       &lt;NA&gt;</span>
<span class="co">#&gt; 2                  &lt;NA&gt;                                       &lt;NA&gt;</span>
<span class="co">#&gt; 3                  &lt;NA&gt; Plant protein of unknown function (DUF247)</span>
<span class="co">#&gt; 4                  &lt;NA&gt;                                       &lt;NA&gt;</span>
<span class="co">#&gt; 5                  &lt;NA&gt;                                       &lt;NA&gt;</span>
<span class="co">#&gt; 6                  &lt;NA&gt;                                       &lt;NA&gt;</span>
<span class="co">#&gt; 7                  &lt;NA&gt;                                       &lt;NA&gt;</span>
<span class="co">#&gt; 8                  &lt;NA&gt;                                       &lt;NA&gt;</span>
<span class="co">#&gt;       Rice homolog Rice gene name</span>
<span class="co">#&gt; 1             &lt;NA&gt;             NA</span>
<span class="co">#&gt; 2             &lt;NA&gt;             NA</span>
<span class="co">#&gt; 3 LOC_Os05g10900.1             NA</span>
<span class="co">#&gt; 4             &lt;NA&gt;             NA</span>
<span class="co">#&gt; 5 LOC_Os04g25680.1             NA</span>
<span class="co">#&gt; 6 LOC_Os04g25680.1             NA</span>
<span class="co">#&gt; 7             &lt;NA&gt;             NA</span>
<span class="co">#&gt; 8             &lt;NA&gt;             NA</span>
<span class="co">#&gt;                                                              Rice gene annotation</span>
<span class="co">#&gt; 1                                                                            &lt;NA&gt;</span>
<span class="co">#&gt; 2                                                                            &lt;NA&gt;</span>
<span class="co">#&gt; 3          plant protein of unknown function domain containing protein, expressed</span>
<span class="co">#&gt; 4                                                                            &lt;NA&gt;</span>
<span class="co">#&gt; 5 ulp1 protease family, C-terminal catalytic domain containing protein, expressed</span>
<span class="co">#&gt; 6 ulp1 protease family, C-terminal catalytic domain containing protein, expressed</span>
<span class="co">#&gt; 7                                                                            &lt;NA&gt;</span>
<span class="co">#&gt; 8                                                                            &lt;NA&gt;</span>
<span class="co">#&gt;   d2_start d2_end distance from gene</span>
<span class="co">#&gt; 1       NA     NA                 NA</span>
<span class="co">#&gt; 2       NA     NA                 NA</span>
<span class="co">#&gt; 3     4230   1100               1100</span>
<span class="co">#&gt; 4       NA     NA                 NA</span>
<span class="co">#&gt; 5       50  -3434                 50</span>
<span class="co">#&gt; 6       50  -3434                 50</span>
<span class="co">#&gt; 7       NA     NA                 NA</span>
<span class="co">#&gt; 8       NA     NA                 NA</span></code></pre></div>
<p><code>pvdiv_table_topsnps</code> will return a list of all of the tables you requested, named according to the criteria used to create the table. You can then save these tables individually as csv or any other type of file.</p>
<p>If the resultant tables are small, say, less than 2000 entries apiece, I favor saving these tables as individual sheets in an Excel file using the R package <code>XLConnect</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">XLConnect</span><span class="op">)</span>

<span class="va">wb1</span> <span class="op">&lt;-</span> <span class="fu">loadWorkbook</span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"Annotation_tables_GWAS_CT.xlsx"</span>, 
                    create <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">anno_tables</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">createSheet</span><span class="op">(</span><span class="va">wb1</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">anno_tables</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">writeWorksheet</span><span class="op">(</span><span class="va">wb1</span>, <span class="va">anno_tables</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, sheet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">anno_tables</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span>
<span class="fu">saveWorkbook</span><span class="op">(</span><span class="va">wb1</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alice MacQueen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
